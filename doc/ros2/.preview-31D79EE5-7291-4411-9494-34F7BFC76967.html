<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/TR/2001/REC-MathML2-20010221/dtd/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<style type="text/css">body { font: 12px Menlo-Regular, Helvetica Neue, Helvetica, Palatino, Georgia, serif; margin: 80px 0; text-align: justify; }
h1, h2, h3, h4, h5, h6 { text-align: left; }
pre, code { font-family: Menlo, "Lucida Console", "Consolas", "Menlo", "Monaco", "Courier", monospace; }#content { max-width: 595.0px; padding: 0.0px 51.0px; }

@font-face {
    font-family: 'New York';
    src: local('New York Semibold');
    font-weight: bold;
}

@font-face {
    font-family: 'New York';
    src: local('New York Semibold');
    font-weight: bold;
    font-style: oblique;
}

@font-face {
    font-family: 'Avenir Next';
    src: local('Avenir Next Demi Bold');
    font-weight: bold;
}

@font-face {
    font-family: 'Avenir Next';
    src: local('Avenir Next Demi Bold');
    font-weight: bold;
    font-style: oblique;
}

/* Common CSS. No colors here, just layout. */

html
{
    /* scroll-behavior: smooth;*/
    -webkit-font-smoothing: antialiased;
}

body
{
	width: 99.9%;
	padding: 0;
	border: 0;
	line-height: 1.8em;
	word-wrap: break-word;
}

#content
{
	margin: 0 auto;
}

/* Disable margin for the very first element in the tree. */
#content > *
{
    margin-top: 0;
}

h1, h2, h3, h4, h5, h6
{
    text-rendering: optimizeLegibility;
    margin: 1.5em 0 0.5em 0;
}

h1
{
    font-size:1.5em;
}

h2
{
    font-size:1.3em;
}

h3
{
    font-size:1.2em;
}

h4, h5, h6
{
    font-size:1.0em;
}

p
{
	margin:1em 0 1em 0;
}

p:last-child
{
	margin:0;
}

hr
{
	width: 100%;
	margin: 3em auto;
	border: 0;
	height: 1px;
}

/* List elements */

ol
{
    list-style: inside decimal;
}

ul
{
    list-style: inside disc;
}

li > ul
{
  list-style: inside circle;
}

li > ul > li > ul
{
  list-style: inside square;
}

ol, ul
{
    padding-left:0;
    margin-bottom:1em;
}

ol li, ul li
{
    margin-left:0;
    text-align: -webkit-match-parent;
}

ol:last-child, ul:last-child
{
    margin:0;
}

li > p
{
    margin-bottom:0.5em;
}

li > ol, li > ul
{
    margin-top: 0.5em !important;
    padding-left:2em;
}

/* Description list elements */

dl
{
	margin-bottom:1em;
}

dl dt
{
	font-weight:bold;
	margin-bottom:0.3em;
}

dl dd
{
	margin-left:0;
	margin-bottom:0.5em;
}

dl dd:last-child, dl:last-child
{
	margin-bottom:0;
}

/* Block code */

pre, code
{
    white-space: pre;
}

pre
{
	width: 96%;
    border: 0px;
    overflow: auto;
    margin-bottom: 2em;
    line-height: 1.4em;
    -webkit-border-radius: 3pt;
    -moz-border-radius: 3pt;
    padding: 1em 1.5em;
    tab-size: 4;
    text-align: start;
}

pre > code
{
    padding: 0;
}

code
{
    font-size: 85%;
    padding: 2pt 3pt;
    -webkit-border-radius: 2pt;
    -moz-border-radius: 2pt;
}

/* MD Plugins */

.flowchart, .flow
{
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent !important;
}

.mermaid
{
    background: transparent !important;
}

.pieTitleText {
  font-size: 1.2em !important;
}

/* Block quotes */

blockquote
{
	margin-left: 0;
	margin-right: auto;
	width: 96%;
	padding: 0 0.5em;
	border-left: 3px solid;
}

blockquote > *
{
    text-align: inherit;
}

/* Tables */

table
{
	margin-left: auto;
	margin-right: auto;
	margin-bottom: 1em;
	border-bottom: 1px solid;
	border-right: 1px solid;
	border-spacing: 0;
}

table th
{
	padding: 3px 10px;
	border-top: 1px solid;
	border-left: 1px solid;
}

table td
{
	padding: 3px 10px;
	border-top: 1px solid;
	border-left: 1px solid;
}

caption
{
    font-size: 1.0em;
    text-decoration: italic;
    margin-bottom: 5px;
}

/* Images */

figure
{
	display: block;
	text-align: center;
    margin: auto;
}

img
{
	border: none;
	margin: 1em auto;
	max-width: 100%;
}

figcaption
{
	font-size: 1.0em;
	font-style: italic;
}

mark
{
	padding:1px 3px;
}
@media screen
{
	/* Light theme */
    
    body.light_theme
    {
        background-color: white;
        color: #333333;
    }
    
    .light_theme a
    {
      color: #139aff;
    }
    
    .light_theme hr
    {
      background-color: #E0E0E0;
    }
    
    .light_theme pre, .light_theme code
    {
        color: inherit;
        background-color: #F5F5F5;
    }
    
    .light_theme blockquote
    {
        border-color: #7F7F7F;
        color: #7F7F7F;
    }
    
    .light_theme mark
    {
        background-color: yellow;
    }
    
    .light_theme table
    {
        border-color: #dddddd;
    }
    
    .light_theme table th
    {
        background-color: #eeeeee;
        border-color: #dddddd;
    }
    
    .light_theme table td
    {
        border-color: #dddddd;
    }
    
    .light_theme li.selected
    {
        color: #cccccc;
        text-decoration: line-through;
        list-style-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMycgaGVpZ2h0PScxMyc+IDxyZWN0IHN0cm9rZT0nI2NjY2NjYycgc3Ryb2tlLXdpZHRoPScwLjUnIHN0cm9rZS1taXRlcmxpbWl0PScxMCcgZmlsbD0nI0ZGRkZGRicgeD0nMC4yNScgeT0nMC4yNScgd2lkdGg9JzEyLjUnIGhlaWdodD0nMTIuNScgcng9JzInIC8+PGcgdHJhbnNmb3JtPSd0cmFuc2xhdGUoNywgNikgcm90YXRlKDQ1KScgZmlsbD0nIzEzOWFmZicgc3Ryb2tlPSdub25lJz48cmVjdCB4PSctMycgeT0nMicgd2lkdGg9JzUnIGhlaWdodD0nMicgcng9JzEnIC8+PHJlY3QgeD0nMCcgeT0nLTMuNScgd2lkdGg9JzInIGhlaWdodD0nNycgcng9JzEnIC8+PC9nPjwvc3ZnPg==");
    }

    .light_theme li.unselected
    {
        list-style-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMycgaGVpZ2h0PScxMyc+IDxyZWN0IHN0cm9rZT0nI2NjY2NjYycgc3Ryb2tlLXdpZHRoPScwLjUnIHN0cm9rZS1taXRlcmxpbWl0PScxMCcgZmlsbD0nI0ZGRkZGRicgeD0nMC4yNScgeT0nMC4yNScgd2lkdGg9JzEyLjUnIGhlaWdodD0nMTIuNScgcng9JzInIC8+PC9zdmc+");
    }
    
    
    /* Sunset theme */
    
    body.sunset_theme
    {
        background-color: #F9F3E8;
        color: #1e1b17;
    }
    
    .sunset_theme a
    {
      color: #139aff;
    }
    
    .sunset_theme hr
    {
        background-color: #DFCEBA;
    }

    .sunset_theme pre, .sunset_theme code
    {
        color: inherit;
        background-color: #F2ECE1;
    }

    .sunset_theme blockquote
    {
        border-color: #665B4E;
        color: #665B4E;
    }
    
    .sunset_theme mark
    {
        background-color: khaki;
    }
    
    .sunset_theme table
    {
        border-color: #baae9c;
    }
    
    .sunset_theme table th
    {
        background-color: #e9e3d8;
        border-color: #baae9c;
    }
    
    .sunset_theme table td
    {
        border-color: #baae9c;
    }
    
    .sunset_theme li.selected
    {
        color: #baae9c;
        text-decoration: line-through;
        list-style-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMycgaGVpZ2h0PScxMyc+IDxyZWN0IHN0cm9rZT0nbGlnaHRncmF5JyBzdHJva2Utd2lkdGg9JzAuNScgc3Ryb2tlLW1pdGVybGltaXQ9JzEwJyBmaWxsPScjRkZGRkZGJyB4PScwLjI1JyB5PScwLjI1JyB3aWR0aD0nMTIuNScgaGVpZ2h0PScxMi41JyByeD0nMicgLz4gPGcgdHJhbnNmb3JtPSd0cmFuc2xhdGUoNywgNikgcm90YXRlKDQ1KSc+IDxyZWN0IHN0cm9rZT0nbm9uZScgZmlsbD0nIzEzOWFmZicgeD0nLTMnIHk9JzInIHdpZHRoPSc1JyBoZWlnaHQ9JzInIHJ4PScxJyAvPiA8cmVjdCBzdHJva2U9J25vbmUnIGZpbGw9JyMxMzlhZmYnIHg9JzAnIHk9Jy00JyB3aWR0aD0nMicgaGVpZ2h0PSc3JyByeD0nMScgLz4gPC9nPjwvc3ZnPg==");
    }

    .sunset_theme li.unselected
    {
        list-style-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMycgaGVpZ2h0PScxMyc+IDxyZWN0IHN0cm9rZT0nbGlnaHRncmF5JyBzdHJva2Utd2lkdGg9JzAuNScgc3Ryb2tlLW1pdGVybGltaXQ9JzEwJyBmaWxsPScjRkZGRkZGJyB4PScwLjI1JyB5PScwLjI1JyB3aWR0aD0nMTIuNScgaGVpZ2h0PScxMi41JyByeD0nMicgLz4gPC9zdmc+");
    }
    
    
    /* Dusk theme */
    
    body.dusk_theme
    {
        background-color: #31353D;
        color: #EEEFF7;
    }
    
    .dusk_theme a
    {
        color: #67cccf;
    }
    
    .dusk_theme hr
    {
      background-color: #4E5C6C;
    }
    
    .dusk_theme pre, .dusk_theme code
    {
        color: inherit;
        background-color: #353942;
    }
    
    .dusk_theme blockquote
    {
        border-color: #92CDCF;
        color: #92CDCF;
    }
    
    .dusk_theme mark
    {
        background-color: #92CDCF;
    }
    
    .dusk_theme table
    {
        border-color: #3f454f;
    }
    
    .dusk_theme table th
    {
        background-color: #383d46;
        border-color: #3f454f;
    }
    
    .dusk_theme table td
    {
        border-color: #3f454f;
    }
    
    .dusk_theme li.selected
    {
        color: #6C7E7F;
        text-decoration: line-through;
        list-style-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMycgaGVpZ2h0PScxMyc+IDxyZWN0IHN0cm9rZT0nIzNmNDU0Zicgc3Ryb2tlLXdpZHRoPScwLjUnIHN0cm9rZS1taXRlcmxpbWl0PScxMCcgZmlsbD0nIzM4M2Q0NicgeD0nMC4yNScgeT0nMC4yNScgd2lkdGg9JzEyLjUnIGhlaWdodD0nMTIuNScgcng9JzInIC8+IDxnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDcsIDYpIHJvdGF0ZSg0NSknPiA8cmVjdCBzdHJva2U9J25vbmUnIGZpbGw9JyNFQTRDN0QnIHg9Jy0zJyB5PScyJyB3aWR0aD0nNScgaGVpZ2h0PScyJyByeD0nMScgLz48cmVjdCBzdHJva2U9J25vbmUnIGZpbGw9JyNFQTRDN0QnIHg9JzAnIHk9Jy00JyB3aWR0aD0nMicgaGVpZ2h0PSc3JyByeD0nMScgLz48L2c+PC9zdmc+");
    }

    .dusk_theme li.unselected
    {
        list-style-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMycgaGVpZ2h0PScxMyc+PHJlY3Qgc3Ryb2tlPScjM2Y0NTRmJyBzdHJva2Utd2lkdGg9JzAuNScgc3Ryb2tlLW1pdGVybGltaXQ9JzEwJyBmaWxsPScjMzgzZDQ2JyB4PScwLjI1JyB5PScwLjI1JyB3aWR0aD0nMTIuNScgaGVpZ2h0PScxMi41JyByeD0nMicgLz48L3N2Zz4=");
    }
    
    
    /* Night theme */
    
    body.night_theme
    {
        background-color: #121212;
        color: #DFDFDF;
    }
    
    .night_theme a
    {
        color: #2cbdf3;
    }
    
    .night_theme hr
    {
        background-color: #303030;
    }
    
    .night_theme pre, .night_theme code
    {
        color: inherit;
        background-color: #161616;
    }
    
    .night_theme blockquote
    {
        border-color: #878787;
        color: #878787;
    }
    
    .night_theme mark
    {
        background-color: yellow;
    }
    
    .night_theme table
    {
        border-color: #2b2b2b;
    }
    
    .night_theme table th
    {
        background-color: #222222;
        border-color: #2b2b2b;
    }
    
    .night_theme table td
    {
        border-color: #2b2b2b;
    }
    
    .night_theme li.selected
    {
        color: #878787;
        text-decoration: line-through;
        list-style-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMycgaGVpZ2h0PScxMyc+PHJlY3Qgc3Ryb2tlPSdub25lJyBzdHJva2UtbWl0ZXJsaW1pdD0nMTAnIGZpbGw9JyMyMjIyMjInIHg9JzAuMjUnIHk9JzAuMjUnIHdpZHRoPScxMi41JyBoZWlnaHQ9JzEyLjUnIHJ4PScyJyAvPjxnIHRyYW5zZm9ybT0ndHJhbnNsYXRlKDcsIDYpIHJvdGF0ZSg0NSknPjxyZWN0IHN0cm9rZT0nbm9uZScgZmlsbD0nIzJjYmRmMycgeD0nLTMnIHk9JzInIHdpZHRoPSc1JyBoZWlnaHQ9JzInIHJ4PScxJyAvPjxyZWN0IHN0cm9rZT0nbm9uZScgZmlsbD0nIzJjYmRmMycgeD0nMCcgeT0nLTQnIHdpZHRoPScyJyBoZWlnaHQ9JzcnIHJ4PScxJyAvPjwvZz48L3N2Zz4=");
    }

    .night_theme li.unselected
    {
        list-style-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMycgaGVpZ2h0PScxMyc+PHJlY3Qgc3Ryb2tlPSdub25lJyBzdHJva2UtbWl0ZXJsaW1pdD0nMTAnIGZpbGw9JyMyMjIyMjInIHg9JzAuMjUnIHk9JzAuMjUnIHdpZHRoPScxMi41JyBoZWlnaHQ9JzEyLjUnIHJ4PScyJyAvPjwvc3ZnPg==");
    }
}
</style>
<title>Preview HTML</title>
</head>
<body class="light_theme">
<div id="content">
<h1 id="ros2themen-Übersicht">ROS2 Themen-Übersicht</h1>

<table>
<colgroup>
<col />
<col />
<col />
</colgroup>

<thead>
<tr>
	<th> ROS2   </th>
	<th> Erklärung </th>
	<th> Weitere Infos </th>
</tr>
</thead>

<tbody>
<tr>
	<td> <strong>Topics</strong> </td>
	<td> ROS2 Topics ermöglichen die asynchrone Kommunikation zwischen Nodes. Ein Publisher sendet Nachrichten, während ein Subscriber sie empfängt. Ideal für kontinuierliche Sensordaten oder Steuerbefehle. </td>
	<td> <a href="https://docs.ros.org/en/foxy/Tutorials/Topics/Understanding-ROS2-Topics.html">ROS2 Topics Doku</a> </td>
</tr>
<tr>
	<td> <strong>Services</strong> </td>
	<td> ROS2 Services bieten eine synchrone Kommunikation. Ein Client sendet eine Anfrage, und der Server antwortet. Wird für Anfragen mit garantierter Antwort verwendet. </td>
	<td> <a href="https://docs.ros.org/en/foxy/Tutorials/Services/Understanding-ROS2-Services.html">ROS2 Services Doku</a> </td>
</tr>
<tr>
	<td> <strong>Actions</strong> </td>
	<td> Actions sind für langwierige Aufgaben geeignet. Sie ermöglichen Feedback und die Möglichkeit, eine Aktion vorzeitig abzubrechen. Beispiel: Navigation eines Roboters. </td>
	<td> <a href="https://docs.ros.org/en/foxy/Tutorials/Actions/Understanding-ROS2-Actions.html">ROS2 Actions Doku</a> </td>
</tr>
<tr>
	<td> <strong>Parameter</strong> </td>
	<td> Parameter ermöglichen das Konfigurieren von ROS2-Nodes zur Laufzeit. Beispielsweise kann die Geschwindigkeit eines Roboters angepasst werden, ohne den Code zu ändern. </td>
	<td> <a href="https://docs.ros.org/en/foxy/Tutorials/Parameters/Understanding-ROS2-Parameters.html">ROS2 Parameter Doku</a> </td>
</tr>
<tr>
	<td> <strong>Nodes</strong> </td>
	<td> Ein Node ist eine ausführbare Einheit in ROS2. Mehrere Nodes kommunizieren über Topics, Services oder Actions miteinander. Jeder Node kann spezifische Aufgaben übernehmen. </td>
	<td> <a href="https://docs.ros.org/en/foxy/Tutorials/Understanding-ROS2-Nodes.html">ROS2 Nodes Doku</a> </td>
</tr>
<tr>
	<td> <strong>Launch-Dateien</strong> </td>
	<td> Launch-Dateien ermöglichen das Starten mehrerer Nodes gleichzeitig mit einer vordefinierten Konfiguration. Sie werden in Python geschrieben und sind essenziell für komplexe Anwendungen. </td>
	<td> <a href="https://docs.ros.org/en/foxy/Tutorials/Launch-system.html">ROS2 Launch Doku</a> </td>
</tr>
<tr>
	<td> <strong>Packages</strong> </td>
	<td> Ein ROS2-Package enthält Code, Konfigurationsdateien und Launch-Skripte. Sie werden mit <code>colcon</code> gebaut und verwaltet. </td>
	<td> <a href="https://docs.ros.org/en/foxy/Tutorials/Creating-Your-First-ROS2-Package.html">ROS2 Packages Doku</a> </td>
</tr>
<tr>
	<td> <strong>Bag-Dateien</strong> </td>
	<td> ROS2 Bag-Dateien speichern Nachrichten aus Topics und ermöglichen die spätere Wiedergabe für Analysen oder Tests. Ähnlich einem Black-Box-Recorder für Robotersysteme. </td>
	<td> <a href="https://docs.ros.org/en/foxy/Tutorials/Ros2bag/Recording-And-Playing-Back-Data.html">ROS2 Bag Doku</a> </td>
</tr>
<tr>
	<td> <strong>Colcon Build-System</strong> </td>
	<td> <code>colcon</code> ist das offizielle Build-System für ROS2. Es verwaltet den Code-Compile-Prozess und Abhängigkeiten effizient. </td>
	<td> <a href="https://colcon.readthedocs.io/en/released/">Colcon Build Doku</a> </td>
</tr>
<tr>
	<td> <strong>Dependency Management (<code>rosdep</code>)</strong> </td>
	<td> <code>rosdep</code> hilft beim Installieren von Paketabhängigkeiten, indem es automatisch fehlende Bibliotheken oder Systempakete nachinstalliert. </td>
	<td> <a href="https://docs.ros.org/en/foxy/Tutorials/Intermediate/Rosdep.html">rosdep Doku</a> </td>
</tr>
<tr>
	<td> <strong>Systemdiagnose (<code>ros2 doctor</code>)</strong> </td>
	<td> <code>ros2 doctor</code> analysiert das ROS2-System und zeigt mögliche Probleme oder fehlende Konfigurationen an. </td>
	<td> <a href="https://docs.ros.org/en/foxy/Tutorials/Intermediate/Ros2Doctor.html">ROS2 Doctor Doku</a> </td>
</tr>
</tbody>
</table>

<h1 id="detaillierteinformationenzuros2-anwendungsgebieten">Detaillierte Informationen zu ROS2-Anwendungsgebieten</h1>

<p>Diese Kapitel bieten eine umfassende Beschreibung der verschiedenen Kommunikations- und Steuerungskonzepte in ROS2. Jedes Kapitel erläutert, was mit dem jeweiligen Thema erreicht werden soll, wie es im Umfeld der Robotik genutzt wird und liefert am Ende praktische Beispiele.</p>

<hr />

<h2 id="1.topics">1. TOPICS</h2>

<h3 id="erklärung">Erklärung</h3>

<p>Topics in ROS2 stellen asynchrone Kommunikationskanäle bereit, über die Nachrichten zwischen verschiedenen Nodes ausgetauscht werden können. Ein Node, der Nachrichten veröffentlicht (Publisher), sendet sie über ein Topic, während ein anderer Node, der Nachrichten abonniert (Subscriber), diese empfängt. Dieses Muster eignet sich hervorragend für kontinuierliche Datenströme, wie etwa Sensordaten, Steuerbefehle oder Statusinformationen.</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<p>In der Robotik werden Topics häufig für folgende Zwecke eingesetzt:</p>

<ul>
<li><strong>Sensordatenübertragung:</strong> Kamerabilder, Laserscans, GPS- oder IMU-Daten können in Echtzeit an mehrere Nodes gesendet werden.</li>
<li><strong>Steuerung und Navigation:</strong> Steuerbefehle (z.B. Geschwindigkeits- oder Richtungsanweisungen) werden über Topics an die Bewegungssteuerung eines Roboters gesendet.</li>
<li><strong>Systemstatus und Feedback:</strong> Nodes können Statusupdates oder Fehlermeldungen über Topics an ein zentrales Monitoring-System senden.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Auflisten aller Topics:</strong><br />
<code>ros2 topic list</code><br />
<em>Verwendung:</em> Überwacht die aktiven Kommunikationskanäle im System.</p></li>
<li><p><strong>Nachrichten eines Topics anzeigen:</strong><br />
<code>ros2 topic echo /cmd_vel</code><br />
<em>Verwendung:</em> Zeigt die aktuellen Steuerbefehle, die an das Robotiksystem gesendet werden.</p></li>
<li><p><strong>Nachricht an ein Topic senden:</strong><br />
<code>ros2 topic pub /cmd_vel geometry_msgs/msg/Twist '{linear: {x: 1.0, y: 0.0, z: 0.0}, angular: {x: 0.0, y: 0.0, z: 0.5}}'</code><br />
<em>Verwendung:</em> Sendet eine Steuerungsnachricht, um den Roboter zu bewegen.</p></li>
</ul>

<hr />

<h2 id="2.services">2. SERVICES</h2>

<h3 id="erklärung">Erklärung</h3>

<p>Services in ROS2 ermöglichen eine synchrone Kommunikation zwischen Nodes. Dabei sendet ein Client eine Anfrage an einen Service, und ein spezialisierter Server antwortet darauf. Dieses Request-Response-Modell eignet sich ideal für Aufgaben, bei denen eine unmittelbare und garantierte Antwort erforderlich ist.</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<p>Services werden oft in folgenden Szenarien eingesetzt:</p>

<ul>
<li><strong>Konfigurationsänderungen:</strong> Anpassung von Parametern oder Systemzuständen, die sofortige Rückmeldung erfordern.</li>
<li><strong>Steuerbefehle mit Bestätigung:</strong> Aufgaben wie das Zurücksetzen eines Systems oder das Initiieren eines speziellen Betriebsmodus, bei denen der Erfolg der Operation überprüft werden muss.</li>
<li><strong>Synchronisierte Aktionen:</strong> Operationen, bei denen der Abschluss einer Aufgabe abgewartet werden muss, bevor weitere Schritte erfolgen.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Service-Aufruf ohne Parameter:</strong><br />
<code>ros2 service call /reset std_srvs/srv/Empty</code><br />
<em>Verwendung:</em> Setzt beispielsweise den TurtleSim zurück und erwartet eine Bestätigung.</p></li>
<li><p><strong>Service-Aufruf mit Parametern:</strong><br />
<code>ros2 service call /spawn turtlesim/srv/Spawn '{x: 2.0, y: 3.0, theta: 0.0}'</code><br />
<em>Verwendung:</em> Fordert das Erzeugen eines neuen Elements im System an und übermittelt dabei Positionsdaten.</p></li>
</ul>

<hr />

<h2 id="3.actions">3. ACTIONS</h2>

<h3 id="erklärung">Erklärung</h3>

<p>Actions erweitern das Service-Modell, indem sie eine asynchrone, lang andauernde Operation mit kontinuierlichem Feedback ermöglichen. Während ein Action-Server eine komplexe Aufgabe ausführt, kann der Client fortlaufend Statusupdates erhalten und sogar das Ziel abbrechen.</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<p>Actions sind ideal für Aufgaben, die mehrere Schritte beinhalten und deren Fortschritt überwacht werden soll:</p>

<ul>
<li><strong>Navigation:</strong> Ein Roboter kann einen Zielpunkt ansteuern, während er Feedback über seine aktuelle Position erhält.</li>
<li><strong>Manipulation:</strong> Roboterarme, die Objekte greifen oder bewegen, können über Actions gesteuert werden.</li>
<li><strong>Langwierige Berechnungen:</strong> Aufgaben, die eine gewisse Zeit in Anspruch nehmen, wie etwa Pfadberechnungen oder komplexe Planungsalgorithmen.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Navigation zu einem Zielpunkt:</strong><br />
<code>ros2 action send_goal /navigate_to_pose nav2_msgs/action/NavigateToPose '{pose: {header: {frame_id: &quot;map&quot;}, pose: {position: {x: 2.0, y: 3.0, z: 0.0}, orientation: {z: 0.0, w: 1.0}}}}'</code><br />
<em>Verwendung:</em> Sendet einen Navigationsbefehl an einen Roboter, der zum Zielpunkt navigiert.</p></li>
<li><p><strong>Fibonacci-Berechnung als Action:</strong><br />
<code>ros2 action send_goal /fibonacci action_tutorials_interfaces/action/Fibonacci '{order: 5}'</code><br />
<em>Verwendung:</em> Demonstriert eine beispielhafte Action, bei der die Fibonacci-Folge berechnet wird.</p></li>
</ul>

<hr />

<h2 id="4.parameter">4. PARAMETER</h2>

<h3 id="erklärung">Erklärung</h3>

<p>Parameter in ROS2 ermöglichen es, Nodes zur Laufzeit zu konfigurieren, ohne den Code neu zu kompilieren. Über Parameter können Einstellungen wie Geschwindigkeitsbegrenzungen, Sensor-Kalibrierungswerte oder andere konfigurierbare Eigenschaften eines Systems angepasst werden.</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<ul>
<li><strong>Dynamische Anpassungen:</strong> Ein Roboter kann seine Verhaltensweisen je nach Umgebung oder Betriebsmodus ändern.</li>
<li><strong>Kalibrierung:</strong> Parameter erlauben die Justierung von Sensorempfindlichkeiten oder Steuerungsalgorithmen.</li>
<li><strong>Feinabstimmung:</strong> Ermöglicht das Testen verschiedener Konfigurationen, ohne den Programmcode zu verändern.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Parameter abrufen:</strong><br />
<code>ros2 param get /turtlesim background_r</code><br />
<em>Verwendung:</em> Liest den aktuellen Wert des Hintergrundfarbe-Parameters aus.</p></li>
<li><p><strong>Parameter setzen:</strong><br />
<code>ros2 param set /turtlesim background_r 255</code><br />
<em>Verwendung:</em> Ändert den Parameter zur Laufzeit, um beispielsweise die Hintergrundfarbe zu aktualisieren.</p></li>
</ul>

<hr />

<h2 id="5.nodes">5. NODES</h2>

<h3 id="erklärung">Erklärung</h3>

<p>Nodes sind die grundlegenden Bausteine eines ROS2-Systems. Jeder Node ist ein eigenständiges Programm, das eine bestimmte Aufgabe übernimmt, etwa das Verarbeiten von Sensordaten oder das Steuern eines Aktuators. Durch die Interaktion von mehreren Nodes wird ein verteiltes System realisiert.</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<ul>
<li><strong>Modulare Architektur:</strong> Erlaubt die Trennung von Aufgaben, z.B. separate Nodes für Sensorik, Datenverarbeitung und Antriebsteuerung.</li>
<li><strong>Skalierbarkeit:</strong> Mehrere Nodes können unabhängig voneinander entwickelt und gewartet werden.</li>
<li><strong>Fehlerisolierung:</strong> Ein Fehler in einem Node beeinträchtigt nicht zwangsläufig das gesamte System.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Node-Liste anzeigen:</strong><br />
<code>ros2 node list</code><br />
<em>Verwendung:</em> Zeigt alle aktiven Nodes im Netzwerk, um die Systemarchitektur zu überwachen.</p></li>
<li><p><strong>Node-Informationen abrufen:</strong><br />
<code>ros2 node info /turtle1</code><br />
<em>Verwendung:</em> Liefert detaillierte Informationen zu einem spezifischen Node, inklusive der verwendeten Topics und Services.</p></li>
</ul>

<hr />

<h2 id="6.launch-dateien">6. LAUNCH-DATEIEN</h2>

<h3 id="erklärung">Erklärung</h3>

<p>Launch-Dateien in ROS2 ermöglichen das Starten mehrerer Nodes und die Konfiguration der gesamten Systemumgebung in einem einzigen Skript. Sie werden üblicherweise in Python geschrieben und bieten Flexibilität beim Zusammenspiel der verschiedenen Komponenten.</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<ul>
<li><strong>Systemstart:</strong> Vereinfachen das gleichzeitige Starten aller benötigten Nodes und Dienste, z.B. beim Hochfahren eines Roboters.</li>
<li><strong>Konfigurationsmanagement:</strong> Ermöglichen es, Umgebungsvariablen und Parameter zentral zu definieren.</li>
<li><strong>Automatisierung:</strong> Erleichtern das Testen und die Implementierung komplexer Szenarien durch automatisiertes Setup.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Einfaches Launch-Beispiel:</strong><br />
<code>ros2 launch turtlesim multisim.launch.py</code><br />
<em>Verwendung:</em> Startet mehrere Instanzen von TurtleSim zur Demonstration paralleler Prozesse.</p></li>
<li><p><strong>Launch mit Navigation:</strong><br />
<code>ros2 launch nav2_bringup navigation2.launch.py</code><br />
<em>Verwendung:</em> Startet das komplette Navigations-Framework eines Roboters.</p></li>
</ul>

<hr />

<h2 id="7.packages">7. PACKAGES</h2>

<h3 id="erklärung">Erklärung</h3>

<p>Ein ROS2-Package ist eine Sammlung von Code, Konfigurationsdateien, Bibliotheken und Launch-Skripten, die zusammen eine bestimmte Funktionalität oder Anwendung bilden. Packages bilden die organisatorische Einheit in ROS2 und ermöglichen Wiederverwendbarkeit und Modularität.</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<ul>
<li><strong>Modularität:</strong> Ermöglicht die Trennung von Funktionalitäten, was die Wartung und Wiederverwendung von Code erleichtert.</li>
<li><strong>Verteilung:</strong> Packages können leicht geteilt, veröffentlicht und in verschiedenen Projekten eingesetzt werden.</li>
<li><strong>Build-Management:</strong> Mit Werkzeugen wie <code>colcon</code> werden Packages effizient kompiliert und getestet.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Neues Package erstellen (Python):</strong><br />
<code>ros2 pkg create my_package --build-type ament_python</code><br />
<em>Verwendung:</em> Erstellt ein neues ROS2-Package für Python-basierte Anwendungen.</p></li>
<li><p><strong>Neues Package erstellen (C++):</strong><br />
<code>ros2 pkg create my_cpp_pkg --build-type ament_cmake</code><br />
<em>Verwendung:</em> Erstellt ein neues ROS2-Package, das C++-Code beinhaltet.</p></li>
</ul>

<hr />

<h2 id="8.bag-dateien">8. BAG-DATEIEN</h2>

<h3 id="erklärung">Erklärung</h3>

<p>ROS2 Bag-Dateien ermöglichen das Aufzeichnen und Wiedergeben von Nachrichten, die über Topics gesendet werden. Sie dienen als Datenlogger, der es erlaubt, Sensordaten, Steuerbefehle oder Systemstatus für die spätere Analyse zu speichern und zu reproduzieren.</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<ul>
<li><strong>Fehlersuche und Debugging:</strong> Aufgezeichnete Daten können analysiert werden, um Fehlerquellen im System zu identifizieren.</li>
<li><strong>Simulation und Test:</strong> Ermöglicht es, reale Daten in einer Simulationsumgebung wiederzugeben, um Algorithmen zu testen.</li>
<li><strong>Datenarchivierung:</strong> Langfristige Speicherung von Messdaten, z.B. für wissenschaftliche Analysen oder zur Überwachung von Langzeitprozessen.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Aufzeichnung von Daten:</strong><br />
<code>ros2 bag record -o my_bag /cmd_vel /scan</code><br />
<em>Verwendung:</em> Zeichnet Steuerbefehle und Sensordaten simultan auf.</p></li>
<li><p><strong>Wiedergabe der aufgezeichneten Daten:</strong><br />
<code>ros2 bag play my_bag</code><br />
<em>Verwendung:</em> Spielt die zuvor aufgezeichneten Daten wieder ab, um das Systemverhalten zu analysieren.</p></li>
</ul>

<hr />

<h2 id="9.colconbuild-system">9. COLCON BUILD-SYSTEM</h2>

<h3 id="erklärung">Erklärung</h3>

<p><code>colcon</code> ist das empfohlene Build-Tool für ROS2 und verwaltet den Kompilierungsprozess eines gesamten Workspaces. Es kümmert sich um Abhängigkeiten, den Parallelbau von Paketen und unterstützt verschiedene Build-Typen (z.B. Python oder C++).</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<ul>
<li><strong>Effizientes Bauen:</strong> Spart Zeit durch parallele Kompilierung mehrerer Pakete.</li>
<li><strong>Modulares Build-System:</strong> Unterstützt die Erstellung von isolierten Paketen, was insbesondere in großen Projekten von Vorteil ist.</li>
<li><strong>Integration:</strong> Lässt sich nahtlos in CI/CD-Pipelines integrieren, um automatisierte Tests und Builds zu ermöglichen.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Gesamtes Workspace bauen:</strong><br />
<code>colcon build --symlink-install</code><br />
<em>Verwendung:</em> Baut alle Packages im aktuellen Workspace und erstellt symbolische Links, die die Entwicklungsarbeit erleichtern.</p></li>
<li><p><strong>Selektives Package bauen:</strong><br />
<code>colcon build --packages-select my_package</code><br />
<em>Verwendung:</em> Baut nur ein spezifisches Package, um schnell Änderungen zu testen.</p></li>
</ul>

<hr />

<h2 id="10.dependencymanagementrosdep">10. DEPENDENCY MANAGEMENT (rosdep)</h2>

<h3 id="erklärung">Erklärung</h3>

<p><code>rosdep</code> ist ein Werkzeug, das die Installation von Abhängigkeiten für ROS2-Pakete automatisiert. Es sorgt dafür, dass alle nötigen Bibliotheken und Systempakete vorhanden sind, die für den Betrieb eines ROS2-Projekts erforderlich sind.</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<ul>
<li><strong>Automatisierung:</strong> Erleichtert die Einrichtung von Entwicklungsumgebungen, indem fehlende Abhängigkeiten automatisch installiert werden.</li>
<li><strong>Konsistenz:</strong> Sorgt dafür, dass alle Entwickler und Produktionssysteme mit denselben Bibliotheken arbeiten, was Kompatibilitätsprobleme reduziert.</li>
<li><strong>Portabilität:</strong> Erlaubt den einfachen Transfer von Projekten auf verschiedene Systeme und Plattformen.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Abhängigkeiten installieren:</strong><br />
<code>rosdep install --from-paths src --ignore-src -r -y</code><br />
<em>Verwendung:</em> Installiert alle für den Quellcode im <code>src</code>-Verzeichnis notwendigen Abhängigkeiten.</p></li>
<li><p><strong>Abhängigkeiten für eine spezifische ROS2-Distribution installieren:</strong><br />
<code>rosdep install --rosdistro humble --ignore-src</code><br />
<em>Verwendung:</em> Sorgt dafür, dass alle Pakete für die ROS2 Humble-Version korrekt installiert sind.</p></li>
</ul>

<hr />

<h2 id="11.systemdiagnoseros2doctor">11. SYSTEMDIAGNOSE (ros2 doctor)</h2>

<h3 id="erklärung">Erklärung</h3>

<p><code>ros2 doctor</code> ist ein Diagnosetool, das den Zustand eines ROS2-Systems überprüft und potenzielle Konfigurations- oder Laufzeitprobleme identifiziert. Es bietet eine schnelle Übersicht über die Systemgesundheit und hilft dabei, Fehler frühzeitig zu erkennen und zu beheben.</p>

<h3 id="nutzunginderrobotik">Nutzung in der Robotik</h3>

<ul>
<li><strong>Fehlerdiagnose:</strong> Hilft dabei, Probleme in der Systemkonfiguration oder im Kommunikationsnetzwerk zu erkennen.</li>
<li><strong>Systemüberwachung:</strong> Wird genutzt, um vor dem Start von komplexen Anwendungen sicherzustellen, dass alle Komponenten korrekt konfiguriert sind.</li>
<li><strong>Automatisierte Berichte:</strong> Kann in automatisierte Testumgebungen integriert werden, um die Systemintegrität regelmäßig zu prüfen.</li>
</ul>

<h3 id="beispiele">Beispiele</h3>

<ul>
<li><p><strong>Basisdiagnose:</strong><br />
<code>ros2 doctor</code><br />
<em>Verwendung:</em> Führt eine schnelle Überprüfung des gesamten ROS2-Systems durch und meldet etwaige Probleme.</p></li>
<li><p><p><strong>Detaillierter Diagnosebericht:</strong><br />
<code>ros2 doctor --report</code><br />
<em>Verwendung:</em> Erstellt einen ausführlichen Bericht, der detaillierte Informationen über mögliche Fehlkonfigurationen und Optimierungspotenziale liefert.</p></p></li>
</ul>

</div>
<script id='rootVars'>
const gResourcePath = '/Applications/iWriter Pro.app/Contents/Resources';
const gAppTheme = 'light_theme';
</script>
<script id='loadMathJax'>
let gScaleValue = 1.0;
let gTagsSide = 'left';
let gShowTags = 'none';
let gMathJaxOutput = 'chtml';

/* Setup and load MatJax lib.  */

window.MathJax = {
    svg: {
            scale: gScaleValue,            // global scaling factor for all expressions
            minScale: .5,                  // smallest scaling factor to use
            mtextInheritFont: false,       // true to make mtext elements use surrounding font
            merrorInheritFont: true,       // true to make merror text use surrounding font
            mathmlSpacing: false,          // true for MathML spacing rules, false for TeX rules
            skipAttributes: {},            // RFDa and other attributes NOT to copy to the output
            exFactor: .5,                  // default size of ex in em units
            displayAlign: 'center',        // default for indentalign when set to 'auto'
            displayIndent: '0',            // default for indentshift when set to 'auto'
            fontCache: 'local',            // or 'global' or 'none'
            localID: null,                 // ID to use for local font cache (for single equation processing)
            internalSpeechTitles: false,   // insert <title> tags with speech content
            titleID: 0                     // initial id number to use for aria-labeledby titles
        },
    chtml: {
            scale: gScaleValue,                      // global scaling factor for all expressions
            minScale: .5,                  // smallest scaling factor to use
            mtextInheritFont: false,       // true to make mtext elements use surrounding font
            merrorInheritFont: true,       // true to make merror text use surrounding font
            mathmlSpacing: false,          // true for MathML spacing rules, false for TeX rules
            skipAttributes: {},            // RFDa and other attributes NOT to copy to the output
            exFactor: .5,                  // default size of ex in em units
            displayAlign: 'center',        // default for indentalign when set to 'auto'
            displayIndent: '0',            // default for indentshift when set to 'auto'
            matchFontHeight: true,         // true to match ex-height of surrounding font
            adaptiveCSS: true              // true means only produce CSS that is used in the processed equations
      },
    tex: {
            tags: gShowTags,
            tagSide: gTagsSide,          // side for \tag macros
            tagIndent: '0.8em'           // amount to indent tags
        },
    options: {
            processHtmlClass: 'math',  //  class that marks tags that should be searched
            renderActions: {
            assistiveMml: [],
            addMenu: [0, '', '']
        }
    }
};

(function () {
    
    var script = document.createElement('script');
    
    // Global vars will be defined at launch
    // gMathJaxOutput can be 'svg' or 'chtml'
    script.src = gResourcePath + "/MathJax/tex-" + gMathJaxOutput + ".js";

    script.async = true;
    script.id = "MathJax-script";
    document.head.appendChild(script);
})();
</script>
<script id='loadMermaid'>

/* Initialize Mermaid lib. */

function mermaidConfig() {
  
    /// Mermaid Theme
    var mermaidTheme = "default";

    /// gAppTheme is defined in "rootVars" script
    if (gAppTheme == "dusk_theme" || gAppTheme == "night_theme")
    {
        mermaidTheme = "dark";
    }

    /// Mermaid configuration
    var config = {
        startOnLoad: true,
        theme: mermaidTheme,
        fontFamily: "-apple-system, Helvetica Neue",
        fontSize:14,
        securityLevel:'loose',
        flowchart:{
            useMaxWidth:true,
            htmlLabels:true,
            fontSize: 16
        },
        flowchart: {
            diagramPadding: 10,
            htmlLabels: true,
            curve: 'basis',
        },
        gantt: {
            useMaxWidth:false,
            fontSize:14
        },
        sequence:{
            useMaxWidth:true,
            fontSize:16
        },
        pie: {
            useMaxWidth:false
        },
    };
    
    return config;
}

(function () {
    var script = document.createElement('script');
    script.src = gResourcePath + "/Mermaid/mermaid.min.js";
    script.async = false;
    script.id = "Mermaid-script";
    document.head.appendChild(script);
    
    script.onload = function() {

        /// Initialize
        const config = mermaidConfig();
        mermaid.initialize(config);
    }
})();
</script>

<script id='loadFlowchart'>
const gYesText = 'Yes';
const gNoText = 'No';

/* Initialize Flowchart lib. */

(function () {
    var script = document.createElement('script');
    script.src = gResourcePath + "/Flowchart/raphael.min.js"; // gResourcePath will be defined at launch
    script.async = false;
    script.id = "Raphael-script";
    document.head.appendChild(script);
    
    var script = document.createElement('script');
    script.src = gResourcePath + "/Flowchart/flowchart.min.js"; // gResourcePath will be defined at launch
    script.async = false;
    script.id = "Flowchart-script";
    document.head.appendChild(script);

    script.onload = function() {
      
        loadFlowchart();
    }
})();

loadFlowchart = function() {
    
    /// Get styling info
    const element = document.body;
    const style = getComputedStyle(element);
    
    let options = {
        //'x':           50,
        //'maxWidth':    5,
        'text-margin':   15,
        'font-size':     16,
        'line-width':    3,
        'font':          'normal',
        'font-family':   '-apple-system, Helvetica Neue, Courier, monospace, serif',
        'font-weight':   'normal',
        'font-color':     style.color,
        'line-color':     style.color,
        'element-color':  style.color,
        'fill':           style.background,
        'yes-text':       gYesText,
        'no-text':        gNoText,
        'arrow-end':      'block',
        'scale':          1.0
    };
    
    /// Draw flowchart
    function drawChartsWithName(className, options) {
        
        let flowchartElements = document.getElementsByClassName(className);
        
        for (let index = 0; index < flowchartElements.length; index++) {
            
            let element = flowchartElements[index];
            const code = element.textContent;

            if (code.length > 0) {

                let chart = flowchart.parse(code);
                element.innerHTML = '';
                chart.drawSVG(element, options);
            }
        }
    }
    
    /// Call flowchart for 2 classes
    drawChartsWithName('flow', options);
    drawChartsWithName('flowchart', options);
};
</script>

<script id='loadHighlight'>

var script = document.createElement('script');
script.src = gResourcePath + "/highlight/highlight.min.js"; // gResourcePath will be defined at launch
script.async = false;
script.id = "Highlight-script";
document.head.appendChild(script);

/// Highlight CSS style
var stylePath = "/highlight/styles/default.min.css";

var theme = gAppTheme;

if (theme == "light_theme")
{
    stylePath = "/highlight/styles/xcode.min.css";
}
else if (theme == "sunset_theme")
{
    stylePath = "/highlight/styles/stackoverflow-light.min.css";
}
else if (theme == "dusk_theme")
{
    stylePath = "/highlight/styles/harmonic16-dark.min.css";
}
else if (theme == "night_theme")
{
    stylePath = "/highlight/styles/stackoverflow-dark.min.css";
}

var link = document.createElement('link');
link.rel = 'stylesheet';
link.type = 'text/css';
link.id = "Highlight-stylesheet";
link.href = gResourcePath + stylePath; // gResourcePath will be defined at launch
document.head.appendChild(link);

script.onload = function() {
  
    hljs.highlightAll();
}

</script>

<script id='ScrollSync-script'>
 
function findAnchorNodes() {
    
    let excludedSelectors = ".trans-wrapper img, .trans-wrapper .mermaid, .trans-wrapper .flow, .trans-wrapper .flowchart";
    let excludedElements = Array.prototype.slice.call(document.querySelectorAll(excludedSelectors));

    let selectors = "#content > h1, #content > h2, #content > h3, #content > h4, #content > h5, #content > h6, #content > hr, #content > blockquote, #content > pre, #content > ul, #content > ol, img, .trans-wrapper, div.mermaid, div.flow, div.flowchart";
    let elements = Array.prototype.slice.call(document.querySelectorAll(selectors));

    return elements.filter(element => !excludedElements.includes(element));
}

function totalHeight() {
    
    let body = document.body;
    let html = document.documentElement;
    return Math.max(body.scrollHeight, body.offsetHeight, html.scrollHeight, html.offsetHeight);
}

/// Easing function from https://github.com/iamdustan/smoothscroll
var ease = t => 0.5 * (1 - Math.cos(Math.PI * t));

// Easing functions from https://gist.github.com/gre/1650294
var linear = t => t;
var easeOutQuad = t => t*(2-t);
var easeInOutCubic = t => t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1;

function smoothScrollTo(yPos, duration = 200) {

    const startY = window.scrollY;
    const difference = yPos - startY;
    const startTime = performance.now();

    function step() {

        const progress = (performance.now() - startTime) / duration;
        const amount = easeOutQuad(progress);
        window.scrollTo({ top: startY + amount * difference });
        if (progress < 0.99) {
            window.requestAnimationFrame(step);
        }
    }
    
    step();
}

// Usage example:
// let lineHeight = parseInt(getStyle('content', 'line-height'), 10);
function getStyle(el, styleProp) {

    var x = document.getElementById(el);

    if (x.currentStyle)
        var y = x.currentStyle[styleProp];
    else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(x,null).getPropertyValue(styleProp);

    return y;
}

function scrollToRatio(value, behavior) {

    let viewportOffset = window.pageYOffset;
    let viewportHeight = window.innerHeight;
    var offset = totalHeight() * value - viewportHeight/2.0;

    let duration = 200.0;

    if (behavior == 2) // animation behavior: none
    {
        window.scrollTo({top: offset, behavior: 'auto'});
    }
    else if (behavior == 1) // animation behavior: animated
    {
        setTimeout(smoothScrollTo(offset, duration), duration);
    }
    else // animation behavior: auto
    {
        if (Math.abs(offset - viewportOffset) > 50.0)
        {
            setTimeout(smoothScrollTo(offset, duration), duration);
        }
        else
        {
            window.scrollTo({top: offset, behavior: 'auto'});
        }
    }
}

function scrollToPercentage(value, behavior) {

    let duration = 200.0;
    let offset = value * totalHeight();

    if (behavior == 2) // animation behavior: none
    {
        window.scrollTo({top: offset, behavior: 'auto'});
    }
    else if (behavior == 1) // animation behavior: animated
    {
        setTimeout(smoothScrollTo(offset, duration), duration);
    }
    else // animation behavior: auto
    {
        let viewportOffset = window.pageYOffset;

        if (Math.abs(offset - viewportOffset) > 50.0)
        {
            setTimeout(smoothScrollTo(offset, duration), duration);
        }
        else
        {
            window.scrollTo({top: offset, behavior: 'auto'});
        }
    }
}

function scrollToAnchorElementAtIndex(index, behavior, anchorHeight, offset, maxAnchor, percentage) {

    let elements = findAnchorNodes();
    let len = elements.length;

    if (len != maxAnchor || index > len)
    {
        // Anchor counts don't match, use the fallback value
        scrollToPercentage(percentage, behavior);
    }
    else
    {
        let element = elements[index];
        let viewportOffset = window.pageYOffset;
        let viewportHeight = window.innerHeight;
        let rect = element.getBoundingClientRect();
        var y = rect.top + viewportOffset + offset;

        if (element.className == 'trans-wrapper' && rect.height >= viewportHeight) {
            
            y += rect.height/2;
        }
        
        let duration = 200.0;
        
        if (y < viewportOffset || y > viewportOffset + viewportHeight/2.0) {
            
            if (behavior == 2) // animation behavior: none
            {
                window.scrollTo({top: y, behavior: 'auto'});
            }
            else if (behavior == 1) // animation behavior: animated
            {
                setTimeout(smoothScrollTo(offset, duration), duration);
            }
            else // animation behavior: auto
            {
                if (Math.abs(y - viewportOffset) > 0)
                {
                    setTimeout(smoothScrollTo(offset, duration), duration);
                }
                else
                {
                    window.scrollTo({top: y, behavior: 'auto'});
                }
            }
        }
    }
}

function scrollByDelta(delta, textHeight) {

    let ratio = totalHeight() / textHeight;

    window.scrollBy({top: delta*ratio, behavior: 'auto'});
}

function scrollToAnchorElementAtIndexWithAlignment(index, behavior, alignment, maxAnchor, percentage) {

    let elements = findAnchorNodes();
    let len = elements.length;
    
    if (len != maxAnchor || index >= len)
    {
        // Anchor counts don't match, use the fallback value
        scrollToPercentage(percentage, behavior);
    }
    else
    {
        let element = elements[index];
        let animation = (behavior == 2) ? 'auto' : 'smooth';
        element.scrollIntoView({ behavior: animation, block: alignment });
    }
}

function getVisibleAnchorAndOffset(editorAnchorCount) {
    
    // Find the visible anchor
    // Count offset
    // return data to a caller
    // Return values are: [anchor index, offset, fallback percentage]
    
    /// Index not found constant
    const IndexNotFound = -1;
    
    // Preview total height
    let height = totalHeight();

    let elements = findAnchorNodes();
    let viewportOffset = Math.max(window.pageYOffset, 0.0);
    let viewportHeight = window.innerHeight;
    var altResult = null;
    
    // Preview is at start
    if (viewportOffset < 30.0) {
        
        return [IndexNotFound, 0, 0.0];
    }
    
    // Preview is at end
    if ((height - (viewportOffset + viewportHeight)) < 50.0) {
        
        return [IndexNotFound, 0, 1.0];
    }
    
    // Percentage value
    let percentage = Math.min(viewportOffset / height, 1.0);
    
    // Anchor counts don't match, return the fallback value
    if (editorAnchorCount != elements.length) {
        
        return [IndexNotFound, 0, percentage];
    }

    /// Try to find the appropriate anchor for smooth scrolling
    for(let index = 0; index < elements.length; index++) {
        
        let item = elements[index];
        let elementRect = item.getBoundingClientRect();
        
        if (elementRect.top >= 0 && elementRect.top <= viewportHeight) {

            // Element is visible in viewport
            return [index, elementRect.top, percentage];
        }
        else if (elementRect.top < 0 && elementRect.bottom > 0) {
            
            // Element is partially visible in viewport
            altResult = [index, elementRect.top, percentage];
        }
    }
    
    if (altResult != null) {
        
        return altResult;
    }
    
    /// Index is not found, return just the scroll percentage
    return [IndexNotFound, 0, percentage];
}

function getScrollPercentage() {

    let height = totalHeight();
    let viewportOffset = window.pageYOffset;
    let viewportHeight = window.innerHeight;
    
    // Preview is at start
    if (viewportOffset < 30.0) {
        
        return 0.0;
    }
    
    // Preview is at end
    if ((height - (viewportOffset + viewportHeight)) < 50.0) {
        
        return 1.0;
    }
    
    // Percentage value
    return Math.min(viewportOffset / height, 1.0);
}
</script>

<script id='reloadImages'>
/* This script will get all images in the document and return their src attributes. */

function reloadImages() {

    var images = document.getElementsByTagName('img');

    for(var image of images) {
        
        // Get the links for non-loaded images
        if (image.naturalWidth == 0 || !image.complete) {

            // Get the src value
            let src = image.getAttribute('src');

            // Disable support for images with file-scheme. It causes various issues with export.
            //if (src.startsWith('file:')) {
            //    image.src = 'iwriter-img:/' + src.slice(5);
            //}
            
            if (!src.startsWith('http')) {
            
                // Add custom scheme to path.
                // This will make PreviewSchemeHandler to handle the image.
                image.src = 'iwriter-img:///' + src;
            }
        }
    }
}

reloadImages();
</script>

</body>
</html>
